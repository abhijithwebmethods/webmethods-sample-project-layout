<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="name">encryptAndSign</value>
  <value name="encodeutf8">true</value>
  <value name="body">Ly8gR2V0IHBsYWluIHRleHQgaW5wdXQNCklEYXRhQ3Vyc29yIHBjID0gcGlwZWxpbmUuZ2V0Q3Vy
c29yKCk7DQpTdHJpbmcgcGxhaW5UZXh0UGF0aCA9IElEYXRhVXRpbC5nZXRTdHJpbmcocGMsICJw
bGFpblRleHRQYXRoIik7DQpieXRlW10gcGxhaW5UZXh0Qnl0ZXMgPSAoYnl0ZVtdKUlEYXRhVXRp
bC5nZXQocGMsICJwbGFpblRleHRCeXRlcyIpOw0KU3RyaW5nIHBsYWluVGV4dFN0cmluZyA9IElE
YXRhVXRpbC5nZXRTdHJpbmcocGMsICJwbGFpblRleHRTdHJpbmciKTsNCklucHV0U3RyZWFtIHBs
YWluVGV4dFN0cmVhbSA9IChJbnB1dFN0cmVhbSlJRGF0YVV0aWwuZ2V0KHBjLCAicGxhaW5UZXh0
U3RyZWFtIik7DQpTdHJpbmcgcGxhaW5UZXh0RW5jb2RpbmcgPSBJRGF0YVV0aWwuZ2V0U3RyaW5n
KHBjLCAicGxhaW5UZXh0RW5jb2RpbmciKTsNCg0KLy8gVmFsaWRhdGUgcGxhaW4gdGV4dCBpbnB1
dA0KYm9vbGVhbiBhdXRvQ2xvc2UgPSBmYWxzZTsNCnRyeSB7DQogICAgaWYgKHBsYWluVGV4dFBh
dGggIT0gbnVsbCAmJiAhcGxhaW5UZXh0UGF0aC5lcXVhbHMoIiIpKSB7DQogICAgICAgIHBsYWlu
VGV4dFN0cmVhbSA9IG5ldyBGaWxlSW5wdXRTdHJlYW0obmV3IEZpbGUocGxhaW5UZXh0UGF0aCkp
Ow0KICAgICAgICBhdXRvQ2xvc2UgPSB0cnVlOw0KICAgIH0gZWxzZSBpZiAocGxhaW5UZXh0Qnl0
ZXMgIT0gbnVsbCAmJiBwbGFpblRleHRCeXRlcy5sZW5ndGggPiAwKSB7DQogICAgICAgIHBsYWlu
VGV4dFN0cmVhbSA9IG5ldyBCeXRlQXJyYXlJbnB1dFN0cmVhbShwbGFpblRleHRCeXRlcyk7DQog
ICAgICAgIGF1dG9DbG9zZSA9IHRydWU7DQogICAgfSBlbHNlIGlmIChwbGFpblRleHRTdHJpbmcg
IT0gbnVsbCAmJiAhcGxhaW5UZXh0U3RyaW5nLmVxdWFscygiIikpIHsNCiAgICAgICAgcGxhaW5U
ZXh0U3RyZWFtID0gbmV3IEJ5dGVBcnJheUlucHV0U3RyZWFtKA0KICAgICAgICAgICAgICAgIHBs
YWluVGV4dFN0cmluZy5nZXRCeXRlcyhwbGFpblRleHRFbmNvZGluZykpOw0KICAgICAgICBhdXRv
Q2xvc2UgPSB0cnVlOw0KICAgIH0gZWxzZSB7DQogICAgICAgIC8vIFRocm93cyBhbiBleGNlcHRp
b24gaWYgdW5hdmFpbGFibGUNCiAgICAgICAgcGxhaW5UZXh0U3RyZWFtLmF2YWlsYWJsZSgpOw0K
ICAgIH0gDQp9IGNhdGNoIChGaWxlTm90Rm91bmRFeGNlcHRpb24gZm5mZSkgew0KICAgIHRocm93
IG5ldyBTZXJ2aWNlRXhjZXB0aW9uKCJQbGFpbiB0ZXh0IGZpbGUgd2FzIG5vdCBmb3VuZCIpOw0K
fSBjYXRjaCAoVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiB1ZWUpIHsNCiAgICB0aHJvdyBu
ZXcgU2VydmljZUV4Y2VwdGlvbigiUGxhaW4gdGV4dCBlbmNvZGluZyBpcyBpbnZhbGlkIik7DQp9
IGNhdGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsNCiAgICB0aHJvdyBuZXcgU2VydmljZUV4Y2VwdGlv
bigiUGxhaW4gdGV4dCBzdHJlYW0gaXMgZW1wdHkiKTsNCn0gY2F0Y2ggKE51bGxQb2ludGVyRXhj
ZXB0aW9uIG5wZSkgew0KICAgIHRocm93IG5ldyBTZXJ2aWNlRXhjZXB0aW9uKCJObyBwbGFpbiBk
YXRhIGF2YWlsYWJsZSIpOw0KfQ0KaWYgKHBsYWluVGV4dEVuY29kaW5nID09IG51bGwgfHwgcGxh
aW5UZXh0RW5jb2RpbmcuZXF1YWxzKCIiKSkgew0KICAgIHBsYWluVGV4dEVuY29kaW5nID0gIlVU
Ri04IjsNCn0gZWxzZSBpZiAoIUNoYXJzZXQuaXNTdXBwb3J0ZWQocGxhaW5UZXh0RW5jb2Rpbmcp
KSB7DQogICAgdGhyb3cgbmV3IFNlcnZpY2VFeGNlcHRpb24oIlVuc3VwcG9ydGVkIGNoYXJhY3Rl
ciBlbmNvZGluZyIpOw0KfQ0KDQovLyBHZXQga2V5IGlucHV0DQpQR1BQdWJsaWNLZXkgcHVibGlj
S2V5ID0gKFBHUFB1YmxpY0tleSkgSURhdGFVdGlsLmdldChwYywgInB1YmxpY0tleSIpOw0KU3Ry
aW5nIGVBbGdvcml0aG0gPSBJRGF0YVV0aWwuZ2V0U3RyaW5nKHBjLCAiZW5jcnlwdGlvbkFsZ29y
aXRobSIpOw0KUEdQUHJpdmF0ZUtleSBwcml2YXRlS2V5ID0gKFBHUFByaXZhdGVLZXkpIElEYXRh
VXRpbC5nZXQocGMsICJwcml2YXRlS2V5Iik7DQpTdHJpbmcgcGFzc3dvcmQgPSBJRGF0YVV0aWwu
Z2V0U3RyaW5nKHBjLCAicHJpdmF0ZUtleVBhc3N3b3JkIik7DQpTdHJpbmcgc0FsZ29yaXRobSA9
IElEYXRhVXRpbC5nZXRTdHJpbmcocGMsICJzaWduaW5nQWxnb3JpdGhtIik7DQoNCi8vIFZhbGlk
YXRlIGtleSBpbnB1dA0KaWYgKHB1YmxpY0tleSA9PSBudWxsICB8fCAhcHVibGljS2V5LmlzRW5j
cnlwdGlvbktleSgpKSB7DQogICAgdGhyb3cgbmV3IFNlcnZpY2VFeGNlcHRpb24oIlB1YmxpYyBr
ZXkgaXMgZW1wdHkgb3Igbm90IGFuIGVuY3J5cHRpb24ga2V5Iik7DQp9IGVsc2UgaWYgKHByaXZh
dGVLZXkgIT0gbnVsbCAmJiAocGFzc3dvcmQgPT0gbnVsbCB8fCBwYXNzd29yZC5lcXVhbHMoIiIp
KSkgew0KICAgIHRocm93IG5ldyBTZXJ2aWNlRXhjZXB0aW9uKCJQcml2YXRlIGtleSBwYXNzd29y
ZCBpcyBlbXB0eSIpOw0KfQ0KDQovLyBHZXQgb3V0cHV0IHNldHRpbmdzDQpTdHJpbmcgb3V0cHV0
VHlwZSA9IElEYXRhVXRpbC5nZXRTdHJpbmcocGMsICJvdXRwdXRUeXBlIik7DQpTdHJpbmcgb3V0
cHV0UGF0aCA9IElEYXRhVXRpbC5nZXRTdHJpbmcocGMsICJvdXRwdXRQYXRoIik7DQoNCi8vIFZh
bGlkYXRlIG91dHB1dCBzZXR0aW5ncw0KaWYgKG91dHB1dFR5cGUgPT0gbnVsbCB8fCBvdXRwdXRU
eXBlLmVxdWFscygiIikpIHsNCiAgICBvdXRwdXRUeXBlID0gIlN0cmluZyI7DQp9IGVsc2UgaWYg
KG91dHB1dFR5cGUuZXF1YWxzKCJGaWxlIikpIHsNCiAgICB0cnkgew0KICAgICAgICBGaWxlIGZp
bGUgPSBuZXcgRmlsZShvdXRwdXRQYXRoKTsNCiAgICAgICAgaWYgKGZpbGUuZXhpc3RzKCkgJiYg
IWZpbGUuY2FuV3JpdGUoKSkgew0KICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbigiRGVz
dGluYXRpb24gZmlsZSBpcyBub3QgYWNjZXNzaWJsZSIpOw0KICAgICAgICB9IGVsc2UgaWYgKCEo
ZmlsZS5nZXRQYXJlbnRGaWxlKCkuZXhpc3RzKCkgfHwgZmlsZS5nZXRQYXJlbnRGaWxlKCkubWtk
aXJzKCkpKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCJEZXN0aW5hdGlvbiBk
aXJlY3RvcnkgaXMgbm90IGFjY2Vzc2libGUiKTsNCiAgICAgICAgfQ0KICAgIH0gY2F0Y2ggKEV4
Y2VwdGlvbiBlKSB7DQogICAgICAgIHRocm93IG5ldyBTZXJ2aWNlRXhjZXB0aW9uKGUuZ2V0TWVz
c2FnZSgpKTsNCiAgICB9DQp9DQoNCi8vIEVuY3J5cHQgZGF0YQ0KQnl0ZUFycmF5T3V0cHV0U3Ry
ZWFtIG91dCA9IG5ldyBCeXRlQXJyYXlPdXRwdXRTdHJlYW0oKTsNCmludCBzaWduZWQgPSAwOw0K
dHJ5IHsNCiAgICBpZiAocHJpdmF0ZUtleSAhPSBudWxsKSB7DQogICAgICAgIC8vIEVuY3J5cHQg
JiBzaWduDQogICAgICAgIGNoYXJbXSBwYXN3ID0gcGFzc3dvcmQudG9DaGFyQXJyYXkoKTsNCiAg
ICAgICAgUEdQRW5jcnlwdC5lbmNyeXB0QW5kU2lnbihwbGFpblRleHRTdHJlYW0sIG91dCwgcHVi
bGljS2V5LA0KICAgICAgICAgICAgICAgIFBHUEluaXQuZ2V0QWxnb3JpdGhtKGVBbGdvcml0aG0p
LCB0cnVlLCBwcml2YXRlS2V5LA0KICAgICAgICAgICAgICAgIHBhc3csIFBHUEluaXQuZ2V0SGFz
aEFsZ29yaXRobShzQWxnb3JpdGhtKSk7DQogICAgICAgIHNpZ25lZCA9IDE7DQogICAgfSBlbHNl
IHsNCiAgICAgICAgLy8gRW5jcnlwdA0KICAgICAgICBQR1BFbmNyeXB0LmVuY3J5cHQocGxhaW5U
ZXh0U3RyZWFtLCBvdXQsIHB1YmxpY0tleSwgDQogICAgICAgICAgICAgICAgUEdQSW5pdC5nZXRB
bGdvcml0aG0oZUFsZ29yaXRobSksIHRydWUsIG51bGwpOw0KICAgIH0NCiAgICBpZiAoYXV0b0Ns
b3NlKSB7DQogICAgICAgIC8vIENsb3NlIHN0cmVhbXMgY3JlYXRlZCBpbiBzZXJ2aWNlDQogICAg
ICAgIHRyeSB7DQogICAgICAgICAgICBwbGFpblRleHRTdHJlYW0uY2xvc2UoKTsNCiAgICAgICAg
fSBjYXRjaCAoRXhjZXB0aW9uIGUpIHt9DQogICAgfQ0KfSBjYXRjaCAoUEdQRXhjZXB0aW9uIHBn
cGUpIHsNCglFeGNlcHRpb24gZSA9IHBncGUuZ2V0VW5kZXJseWluZ0V4Y2VwdGlvbigpOw0KCXRo
cm93IG5ldyBTZXJ2aWNlRXhjZXB0aW9uIChlKTsNCiAgICAvL3Rocm93IG5ldyBTZXJ2aWNlRXhj
ZXB0aW9uKCJVbmFibGUgdG8gZW5jcnlwdCBkYXRhOiAiDQogICAgLy8gICAgICAgICsgcGdwZS5n
ZXRNZXNzYWdlKCkpOw0KfSBjYXRjaCAoTm9TdWNoUHJvdmlkZXJFeGNlcHRpb24gbnNwZSkgew0K
ICAgIHRocm93IG5ldyBTZXJ2aWNlRXhjZXB0aW9uKCJVbmFibGUgdG8gZW5jcnlwdCBkYXRhIHdp
dGgga2V5czogIg0KICAgICAgICAgICAgKyBuc3BlLmdldE1lc3NhZ2UoKSk7DQp9IGNhdGNoIChO
b1N1Y2hBbGdvcml0aG1FeGNlcHRpb24gbnNhZSkgew0KICAgIHRocm93IG5ldyBTZXJ2aWNlRXhj
ZXB0aW9uKCJJbnZhbGlkIGVuY3J5cHRpb24gYWxnb3JpdGhtOiAiDQogICAgICAgICAgICArIG5z
YWUuZ2V0TWVzc2FnZSgpKTsNCn0gY2F0Y2ggKFNpZ25hdHVyZUV4Y2VwdGlvbiBzZSkgew0KICAg
IHRocm93IG5ldyBTZXJ2aWNlRXhjZXB0aW9uKCJJbnZhbGlkIHNpZ25hdHVyZSBhbGdvcml0aG06
ICINCiAgICAgICAgICAgICsgc2UuZ2V0TWVzc2FnZSgpKTsNCn0gY2F0Y2ggKElPRXhjZXB0aW9u
IGlvZSkgew0KICAgIHRocm93IG5ldyBTZXJ2aWNlRXhjZXB0aW9uKCJVbmFibGUgdG8gd3JpdGUg
ZW5jcnlwdGVkIGRhdGE6ICINCiAgICAgICAgICAgICsgaW9lLmdldE1lc3NhZ2UoKSk7DQp9DQoN
Ci8vIEdlbmVyYXRlIG91dHB1dA0KaWYgKG91dHB1dFR5cGUuZXF1YWxzKCJGaWxlIikpIHsNCiAg
ICB0cnkgew0KICAgICAgICBGaWxlIGZpbGUgPSBuZXcgRmlsZShvdXRwdXRQYXRoKTsNCiAgICAg
ICAgRmlsZU91dHB1dFN0cmVhbSBmb3V0ID0gbmV3IEZpbGVPdXRwdXRTdHJlYW0oZmlsZSk7DQog
ICAgICAgIG91dC5mbHVzaCgpOw0KICAgICAgICBmb3V0LndyaXRlKG91dC50b0J5dGVBcnJheSgp
KTsNCiAgICAgICAgZm91dC5mbHVzaCgpOw0KICAgICAgICBmb3V0LmNsb3NlKCk7DQogICAgICAg
IG91dC5jbG9zZSgpOw0KICAgICAgICBJRGF0YVV0aWwucHV0KHBjLCAiY2lwaGVyVGV4dFBhdGgi
LCBmaWxlLmdldEFic29sdXRlUGF0aCgpKTsNCiAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgew0K
ICAgICAgICB0aHJvdyBuZXcgU2VydmljZUV4Y2VwdGlvbigiVW5hYmxlIHRvIHdyaXRlIGNpcGhl
ciB0ZXh0IHRvIGZpbGU6ICIgDQogICAgICAgICAgICAgICAgKyBlLmdldE1lc3NhZ2UoKSk7DQog
ICAgfQ0KfSBlbHNlIGlmIChvdXRwdXRUeXBlLmVxdWFscygiQnl0ZXMiKSkgew0KICAgIHRyeSB7
DQogICAgICAgIG91dC5mbHVzaCgpOw0KICAgICAgICBJRGF0YVV0aWwucHV0KHBjLCAiY2lwaGVy
VGV4dEJ5dGVzIiwgb3V0LnRvQnl0ZUFycmF5KCkpOw0KICAgICAgICBvdXQuY2xvc2UoKTsNCiAg
ICB9IGNhdGNoIChFeGNlcHRpb24gZSkgew0KICAgICAgICB0aHJvdyBuZXcgU2VydmljZUV4Y2Vw
dGlvbigiVW5hYmxlIHRvIGRlY29kZSBjaXBoZXIgZGF0YTogIg0KICAgICAgICAgICAgICAgICsg
ZS5nZXRNZXNzYWdlKCkpOw0KICAgIH0NCn0gZWxzZSBpZiAob3V0cHV0VHlwZS5lcXVhbHMoIlN0
cmVhbSIpKSB7DQogICAgdHJ5IHsNCiAgICAgICAgb3V0LmZsdXNoKCk7DQogICAgICAgIEJ5dGVB
cnJheUlucHV0U3RyZWFtIHN0cmVhbSA9IG5ldyBCeXRlQXJyYXlJbnB1dFN0cmVhbShvdXQudG9C
eXRlQXJyYXkoKSk7DQogICAgICAgIElEYXRhVXRpbC5wdXQocGMsICJjaXBoZXJUZXh0U3RyZWFt
Iiwgc3RyZWFtKTsNCiAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgew0KICAgICAgICB0aHJvdyBu
ZXcgU2VydmljZUV4Y2VwdGlvbigiVW5hYmxlIHRvIGRlY29kZSBjaXBoZXIgZGF0YTogIg0KICAg
ICAgICAgICAgICAgICsgZS5nZXRNZXNzYWdlKCkpOw0KICAgIH0NCn0gZWxzZSBpZiAob3V0cHV0
VHlwZS5lcXVhbHMoIlN0cmluZyIpKSB7DQogICAgdHJ5IHsNCiAgICAgICAgb3V0LmZsdXNoKCk7
DQogICAgICAgIElEYXRhVXRpbC5wdXQocGMsICJjaXBoZXJUZXh0U3RyaW5nIiwgb3V0LnRvU3Ry
aW5nKCJVVEYtOCIpKTsNCiAgICAgICAgb3V0LmNsb3NlKCk7DQogICAgfSBjYXRjaCAoRXhjZXB0
aW9uIGUpIHsNCiAgICAgICAgdGhyb3cgbmV3IFNlcnZpY2VFeGNlcHRpb24oIlVuYWJsZSB0byBk
ZWNvZGUgY2lwaGVyIGRhdGE6ICINCiAgICAgICAgICAgICAgICArIGUuZ2V0TWVzc2FnZSgpKTsN
CiAgICB9DQp9DQoNCi8vIFJldHVybiBkYXRhDQpJRGF0YVV0aWwucHV0KHBjLCAic2lnbmVkIiwg
U3RyaW5nLnZhbHVlT2Yoc2lnbmVkKSk7DQpwYy5kZXN0cm95KCk7DQoJ</value>
</Values>
